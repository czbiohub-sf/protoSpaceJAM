![Python version](https://img.shields.io/badge/python-3.9%20%7C%203.10-blue)
<a href="https://czbiohub-sf.github.io/protoSpaceJAM/index.html">
<img src="https://img.shields.io/static/v1?message=Docs&logo=data:image/png;base64,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&labelColor=grey&color=black&logoColor=white&label=%20"/>
</a>
![license](https://img.shields.io/badge/license-BSD--3-brightgreen)
![status](https://img.shields.io/badge/status-pre--release-orange)
# protoSpaceJAM 
:computer: protoSpaceJAM is a python package to design guide RNA and repair donors for CRISPR knock-in experiments at scale.  
:globe_with_meridians: protoSpaceJAM can be accessed through our web portal at [http://protospacejam.czbiohub.org/](http://protospacejam.czbiohub.org/).  
:open_book: protoSpaceJAM is described in our [preprint](https://www.biorxiv.org/content/10.1101/2023.10.04.560793v1).

&nbsp;
## Key features:  
- Fully standalone, no calling to other bioinformatics servers
- Sophisticated guide RNA ranking system ([details](https://czbiohub-sf.github.io/protoSpaceJAM/algorithm.html#grna-scoring))
  - Specificity weight
  - Penalize cuts near exon-intron junctions etc.
  - Penalize cuts far away from the payload insertion site
- Sophisticated DNA donor design ([details](https://czbiohub-sf.github.io/protoSpaceJAM/algorithm.html#recoding-strategy))
  - Recode to prevent recut
  - Recode to facilitate payload insertion and prevent recut
  - Automated selection of of ssDNA donor for maximum chance of payload insertion and prevent recut
  - Scan and trim hard-to-synthesis motifs
  - Center the DNA donor around the region containing the payload and recoded bases. 
  - Enforce maximum length of DNA donor
- Use/generate pre-computed genome-wide guide RNAs and their properties for fast runtime

&nbsp;
## Installation

### Clone the repository
```
git clone https://github.com/czbiohub/protoSpaceJAM
```
### Go the repository directory, switch the branch if running branch other than master
```
cd protoSpaceJAM
git checkout main
```
### Create conda environment and activate it
```
conda create -y -n protospacejam python=3.9 && conda activate protospacejam
```
### Install protoSpaceJAM
```
pip install .
```
### Download and unzip pre-computed data

:floppy_disk: 41G disk space (82G temporary) required for (humanüï∫, mouseüê≠ and zebrafishüêü genomes) x (SpCas9, VQR-SpCas9 and enAsCas12a)  
```
python ./protoSpaceJAM/util/download_precomputed_results.py
```
If the download process is disrupted, rerun the same command to resume.  
If prompted to download with browser, place the file in `protoSpaceJAM/protoSpaceJAM/` and rerun the command with an additional argument `--use_local`   

[less disk space option]  
:floppy_disk: 25G disk space (50G temporary), add additional argument `--SpCas9_only`

üëâ If you like to precompute your own gRNAs, please follow instructions [here](https://github.com/czbiohub-sf/protoSpaceJAM/tree/main/protoSpaceJAM/precompute)

### Run a quick test to verify installation
```
python ./protoSpaceJAM/tests/run_quick_test_pJAM.py
```
A successful test will have a printout similar to `Ran 2 tests in 14.644s   OK` at the end.

full test suite can be run with 
```
python ./protoSpaceJAM/tests/run_full_test_pJAM.py
```
A successful test will have a printout similar to Ran 2 tests in 1873.836s` at the end.

&nbsp;
## Usage
```
conda activate protospacejam
protoSpaceJAM --path2csv input/test_input.csv --outdir output/test
```

&nbsp;
## License
Distributed under the terms of the BSD-3 license, "protoSpaceJAM" is free and open source software
